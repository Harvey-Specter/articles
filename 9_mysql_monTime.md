# 平均 SQL 応答時間の監視

> MySQL で平均 SQL 応答時間を監視するにはどうすればよいですか?

## 問題の原因
MySQL パフォーマンス指標の監視では、スループットを測定するための 2 つの重要な指標である tps (1 秒あたりのトランザクション数) と qps (1 秒あたりの要求数) に注目することに加えて、平均 SQL 応答時間も監視する必要があります。

# How
いくつかのオプションがあります:

1. MySQL が提供する Benchmarkark() 関数を使用します。 この関数の機能は、N 回の特定の呼び出しをシミュレートすることです。これにより、この関数を使用して N 個の特別なストアド プロシージャを呼び出し、実行時間に応じた平均 SQL 応答時間の基礎としてこの関数を使用できます。

2. pt-query-digest ツールを tcpdump と組み合わせて使用​​して、各 SQL 要求をリアルタイムでキャプチャすると、各 SQL 要求の応答時間を分析することもできます。

3. Percona または MariaDB ブランチ バージョンで提供される QUERY_RESPONSE_TIME プラグイン関数を使用します。これは、ヒストグラム関数と同様に、平均 SQL 応答時間の分布間隔をカウントするのに役立ちます。

1つ目は比較的シンプルだけど精度が足りない(でも十分)、2つ目はちょっと面倒だけどリクエストごとの詳細な記録が見られる、3つ目は全体の分布しか見えなくて全体像が見えない各リクエストの詳細 リクエストの詳細な記録。

最後に書く

パフォーマンス メトリックを監視するときは、スループットに加えて、リクエストごとの平均応答時間にも注目する必要があります。 高速道路の料金所を例にとると、基本的に同時充電容量（tps）を示すことができる料金所がいくつかあり、各車両の平均通過時間が長い場合、我慢できないと思います:)